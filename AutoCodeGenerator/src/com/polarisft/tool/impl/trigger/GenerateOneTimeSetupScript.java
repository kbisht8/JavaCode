package com.polarisft.tool.impl.trigger;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import com.polarisft.tool.resources.StaticContainers;
import com.polarisft.tool.trigger.AbstractScriptTemplate;
import com.polarisft.tool.trigger.bean.TableInformationBean;
public class GenerateOneTimeSetupScript extends AbstractScriptTemplate {
    //@SuppressWarnings("null")
	private static	Map<String,String> staticMap;
	private static StaticContainers staticContainers;
	public void generateScript(List<TableInformationBean> tableInformationBeanList, String outputPath) {
        String lineSeparator = System.getProperty("line.separator");
        staticMap = new HashMap<String,String>();
		staticMap = staticContainers.getMyMap();
		String CreateStagingDB=staticMap.get("CreateStagingDB");
		String CreateGDCDB=staticMap.get("CreateGDCDB");
		String MSSQLStagingDBName=staticMap.get("MSSQLStagingDBName");
		String MSSQLGDCDBName=staticMap.get("MSSQLGDCDBName");
		String RunSQLAgentJobs=staticMap.get("RunSQLAgentJobs");
		String GrantBPMUserAccess=staticMap.get("GrantBPMUserAccess");
		String SQLOPUser=staticMap.get("SQLOPUser");
		String SQLDevUser=staticMap.get("SQLDevUser");
		String SQLDevUserName= MSSQLGDCDBName.substring(0, 2);
		String SQLOPUserName= MSSQLGDCDBName.substring(0, 2);
		SQLOPUserName=SQLOPUserName + "OPUser";
		SQLDevUserName=SQLDevUserName + "DevUser";

        TableInformationBean tableInformationBean = tableInformationBeanList.get(0);
        StringBuffer stagingFileContentsBuffer = null;
        stagingFileContentsBuffer =  new StringBuffer();

        //CREATE SCHEMA GDC
        	stagingFileContentsBuffer.append("USE [master]").append(lineSeparator);
        	stagingFileContentsBuffer.append("GO").append(lineSeparator);
        	stagingFileContentsBuffer.append(lineSeparator);
        	
        	if(CreateStagingDB.equalsIgnoreCase("y")){
	        	stagingFileContentsBuffer.append("CREATE DATABASE "+MSSQLStagingDBName+"").append(lineSeparator);
	        	stagingFileContentsBuffer.append("GO").append(lineSeparator);
	        	stagingFileContentsBuffer.append(lineSeparator);
	        	stagingFileContentsBuffer.append(lineSeparator);
        	}
        	
        	
        	
        	if(CreateGDCDB.equalsIgnoreCase("y")){
        	stagingFileContentsBuffer.append("CREATE DATABASE "+MSSQLGDCDBName+"").append(lineSeparator);
        	stagingFileContentsBuffer.append("GO").append(lineSeparator);
        	stagingFileContentsBuffer.append(lineSeparator);
        	stagingFileContentsBuffer.append(lineSeparator);
        	}
        	stagingFileContentsBuffer.append("USE ["+tableInformationBean.getTargetDatabaseName()+"]").append(lineSeparator);
        	stagingFileContentsBuffer.append("GO").append(lineSeparator);
        	stagingFileContentsBuffer.append("CREATE SCHEMA ["+tableInformationBean.getTargetSchemaName()+"]").append(lineSeparator);
        	stagingFileContentsBuffer.append("GO").append(lineSeparator);
        	//CREATE SCHEMA STAGING
        	stagingFileContentsBuffer.append("USE ["+tableInformationBean.getSourceDatabaseName()+"]").append(lineSeparator);
        	stagingFileContentsBuffer.append("GO").append(lineSeparator);
        	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
        	stagingFileContentsBuffer.append("CREATE SCHEMA ["+tableInformationBean.getSourceSchemaName()+"]").append(lineSeparator);
        	stagingFileContentsBuffer.append("GO").append(lineSeparator);
        	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	
         	//Grant Permission to BPMUser
         	if(GrantBPMUserAccess.equalsIgnoreCase("y")){
        		stagingFileContentsBuffer.append(lineSeparator);
        		stagingFileContentsBuffer.append("USE master").append(lineSeparator);
        		stagingFileContentsBuffer.append("GO").append(lineSeparator);
        		stagingFileContentsBuffer.append("IF NOT EXISTS").append(lineSeparator); 
        		stagingFileContentsBuffer.append("(SELECT name From master.sys.server_principals Where name = 'BPMDFCUser')").append(lineSeparator);
        		stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
        		stagingFileContentsBuffer.append("CREATE LOGIN [BPMDFCUser] WITH PASSWORD = N'dfcbpm6.x'").append(lineSeparator);
        		stagingFileContentsBuffer.append("END").append(lineSeparator);
        		stagingFileContentsBuffer.append("GO").append(lineSeparator);
        		stagingFileContentsBuffer.append(lineSeparator);
        		stagingFileContentsBuffer.append("USE "+MSSQLStagingDBName+"").append(lineSeparator);
        		stagingFileContentsBuffer.append("GO").append(lineSeparator);
        		stagingFileContentsBuffer.append("CREATE USER [BPMDFCUser] FOR LOGIN [BPMDFCUser]").append(lineSeparator);
        		stagingFileContentsBuffer.append("GO").append(lineSeparator);
        		stagingFileContentsBuffer.append(lineSeparator);
        		stagingFileContentsBuffer.append("EXEC sp_addrolemember N'db_owner', N'BPMDFCUser'").append(lineSeparator);
        		stagingFileContentsBuffer.append("GO").append(lineSeparator);
        		stagingFileContentsBuffer.append(lineSeparator);
        		stagingFileContentsBuffer.append("USE "+MSSQLGDCDBName+"").append(lineSeparator);
          		stagingFileContentsBuffer.append("GO").append(lineSeparator);
        		stagingFileContentsBuffer.append(lineSeparator);
        		stagingFileContentsBuffer.append("CREATE USER [BPMDFCUser] FOR LOGIN [BPMDFCUser]").append(lineSeparator);
        		stagingFileContentsBuffer.append("GO").append(lineSeparator);
        		stagingFileContentsBuffer.append(lineSeparator);
        		stagingFileContentsBuffer.append("EXEC sp_addrolemember N'db_owner', N'BPMDFCUser'").append(lineSeparator);
        		stagingFileContentsBuffer.append("GO").append(lineSeparator);
        		stagingFileContentsBuffer.append(lineSeparator);
        		stagingFileContentsBuffer.append(lineSeparator);
        	}
         	
         	if(SQLOPUser.equalsIgnoreCase("y"))
         	{
         		stagingFileContentsBuffer.append("USE [master]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("GO").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("IF NOT EXISTS").append(lineSeparator); 
        		stagingFileContentsBuffer.append("(SELECT name From master.sys.server_principals Where name = '"+SQLOPUserName+"')").append(lineSeparator);
        		stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
         		stagingFileContentsBuffer.append("CREATE LOGIN ["+SQLOPUserName+"] WITH PASSWORD=N'temp123', DEFAULT_DATABASE=[master], CHECK_EXPIRATION=OFF, CHECK_POLICY=OFF").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("USE ["+MSSQLGDCDBName+"]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("CREATE USER ["+SQLOPUserName+"] FOR LOGIN ["+SQLOPUserName+"]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("USE ["+MSSQLGDCDBName+"]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("ALTER USER ["+SQLOPUserName+"] WITH DEFAULT_SCHEMA=["+tableInformationBean.getTargetSchemaName()+"]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("USE ["+MSSQLGDCDBName+"]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("EXEC sp_addrolemember N'db_datareader', N'"+SQLOPUserName+"'").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("USE ["+MSSQLStagingDBName+"]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("CREATE USER ["+SQLOPUserName+"] FOR LOGIN ["+SQLOPUserName+"]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("USE ["+MSSQLStagingDBName+"]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("ALTER USER ["+SQLOPUserName+"] WITH DEFAULT_SCHEMA=["+tableInformationBean.getSourceSchemaName()+"]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("USE [JPNStaging]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("EXEC sp_addrolemember N'db_datareader', N'"+SQLOPUserName+"'").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("END").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("GO").append(lineSeparator) ;
         		stagingFileContentsBuffer.append(lineSeparator);
         		stagingFileContentsBuffer.append(lineSeparator);
         	}
         	
         	
         	if(SQLDevUser.equalsIgnoreCase("y"))
         	{
         		stagingFileContentsBuffer.append("USE [master]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("GO").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("IF NOT EXISTS").append(lineSeparator); 
        		stagingFileContentsBuffer.append("(SELECT name From master.sys.server_principals Where name = '"+SQLDevUserName+"')").append(lineSeparator);
        		stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
         		stagingFileContentsBuffer.append("CREATE LOGIN ["+SQLDevUserName+"] WITH PASSWORD=N'temp123', DEFAULT_DATABASE=[master], CHECK_EXPIRATION=OFF, CHECK_POLICY=OFF").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("USE ["+MSSQLGDCDBName+"]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("CREATE USER ["+SQLDevUserName+"] FOR LOGIN ["+SQLDevUserName+"]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("USE ["+MSSQLGDCDBName+"]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("ALTER USER ["+SQLDevUserName+"] WITH DEFAULT_SCHEMA=["+tableInformationBean.getTargetSchemaName()+"]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("USE ["+MSSQLGDCDBName+"]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("EXEC sp_addrolemember N'db_datareader', N'"+SQLDevUserName+"'").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("USE ["+MSSQLStagingDBName+"]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("CREATE USER ["+SQLDevUserName+"] FOR LOGIN ["+SQLDevUserName+"]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("USE ["+MSSQLStagingDBName+"]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("ALTER USER ["+SQLDevUserName+"] WITH DEFAULT_SCHEMA=["+tableInformationBean.getSourceSchemaName()+"]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("USE ["+MSSQLStagingDBName+"]").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("EXEC sp_addrolemember N'db_datareader', N'"+SQLDevUserName+"'").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("END").append(lineSeparator) ;
         		stagingFileContentsBuffer.append("GO").append(lineSeparator) ;
         		stagingFileContentsBuffer.append(lineSeparator);
         		stagingFileContentsBuffer.append(lineSeparator);
         	}
         	
       			
        	//Create ETLControlTable In Staging DB
        	stagingFileContentsBuffer.append("USE ["+tableInformationBean.getSourceDatabaseName()+"]").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("GO").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("CREATE TABLE ").append(tableInformationBean.getSourceDatabaseName()).append(".").append(tableInformationBean.getSourceSchemaName()).append(".");
        	stagingFileContentsBuffer.append("ETLControlTable(").append(lineSeparator);
        	stagingFileContentsBuffer.append("StagingTableName VARCHAR(50) NOT NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("ProcedureName VARCHAR(100),").append(lineSeparator);
        	stagingFileContentsBuffer.append("NewRecordPresentFlag CHAR(1),").append(lineSeparator);
        	stagingFileContentsBuffer.append("IsProcedureRunningFlag CHAR(1),").append(lineSeparator);
        	stagingFileContentsBuffer.append("ExecutionBatchSize INT);").append(lineSeparator);
        	stagingFileContentsBuffer.append("GO").append(lineSeparator);
        	stagingFileContentsBuffer.append("ALTER TABLE ").append(tableInformationBean.getSourceDatabaseName()).append(".").append(tableInformationBean.getSourceSchemaName()).append(".");
        	stagingFileContentsBuffer.append("ETLControlTable ADD CONSTRAINT PK_ETLControlTable PRIMARY KEY (StagingTableName);").append(lineSeparator);
        	stagingFileContentsBuffer.append("GO").append(lineSeparator).append(lineSeparator);
        	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);

         	
         	//Create Error Log Table
         	stagingFileContentsBuffer.append("CREATE TABLE ").append(tableInformationBean.getSourceDatabaseName()).append(".").append(tableInformationBean.getSourceSchemaName()).append(".");
         	stagingFileContentsBuffer.append("DFCStoredProcedureErrorLog(").append(lineSeparator);
         	stagingFileContentsBuffer.append("Id Int Identity(1,1),").append(lineSeparator);
         	stagingFileContentsBuffer.append("StoredProcedureName Varchar(50),").append(lineSeparator);
         	stagingFileContentsBuffer.append("ErrorNumber Varchar(30),").append(lineSeparator);
         	stagingFileContentsBuffer.append("ErrorMessage Varchar(4000),").append(lineSeparator);
         	stagingFileContentsBuffer.append("ErrorTimeStamp DateTime);").append(lineSeparator);
         	stagingFileContentsBuffer.append("GO").append(lineSeparator).append(lineSeparator);
        	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	
         	
         	
         	stagingFileContentsBuffer.append("CREATE TABLE ").append(tableInformationBean.getSourceDatabaseName()).append(".").append(tableInformationBean.getSourceSchemaName()).append(".");
        	stagingFileContentsBuffer.append("DFCParameterMaster(").append(lineSeparator);
        	stagingFileContentsBuffer.append("ReconcialiationBatchSize Int);").append(lineSeparator);
        	stagingFileContentsBuffer.append("GO").append(lineSeparator);
        	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append("Insert Into ").append(tableInformationBean.getSourceSchemaName()).append(".").append("DFCParameterMaster").append(lineSeparator);
         	stagingFileContentsBuffer.append("Values (400);").append(lineSeparator);
         	stagingFileContentsBuffer.append("GO").append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	
         	//Create DFCError In Staging DB
        	stagingFileContentsBuffer.append("CREATE TABLE ").append(tableInformationBean.getSourceDatabaseName()).append(".").append(tableInformationBean.getSourceSchemaName()).append(".");
        	stagingFileContentsBuffer.append("DFCError(").append(lineSeparator);
        	stagingFileContentsBuffer.append("STG_ID BIGINT NOT NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("TR_TRANSACTION_DATETIME DATETIME NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("StagingTableName VARCHAR(50) NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("ErrorCode VARCHAR(30) NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("ErrorDescription VARCHAR(1000) NULL);").append(lineSeparator);
        	stagingFileContentsBuffer.append("GO").append(lineSeparator);
        	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
        	//Create DFCReconciliation In Staging DB
        	
        	stagingFileContentsBuffer.append("CREATE TABLE ").append(tableInformationBean.getSourceDatabaseName()).append(".").append(tableInformationBean.getSourceSchemaName()).append(".");
        	stagingFileContentsBuffer.append("DFCReconciliation(").append(lineSeparator);
        	stagingFileContentsBuffer.append("BufferSequenceNumber Numeric(30, 0) NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("StagingId Numeric(18, 0) NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("StagingTableName Nvarchar(50) NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("BufferTableName Nvarchar(10) NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("ReplicationStatus Numeric(2, 0) NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("ReplicationUpdateStatus Numeric(2, 0) NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("ReplicationDateTime Datetime NULL);").append(lineSeparator);
        	stagingFileContentsBuffer.append("GO").append(lineSeparator);
        	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
        	//Create DFCReconciliationArchive In Staging DB
        	stagingFileContentsBuffer.append("CREATE TABLE ").append(tableInformationBean.getSourceDatabaseName()).append(".").append(tableInformationBean.getSourceSchemaName()).append(".");
        	stagingFileContentsBuffer.append("DFCReconciliationArchive(").append(lineSeparator);
        	stagingFileContentsBuffer.append("BufferSequenceNumber Numeric(30, 0) NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("StagingId Numeric(18, 0) NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("StagingTableName Nvarchar(50) NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("BufferTableName Nvarchar(10) NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("ReplicationStatus Numeric(2, 0) NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("ReplicationUpdateStatus Numeric(2, 0) NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("ReplicationDateTime Datetime NULL);").append(lineSeparator);
        	stagingFileContentsBuffer.append("GO").append(lineSeparator);
        	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
        	//Create Reconciliation In Staging DB
        	stagingFileContentsBuffer.append("CREATE TABLE ["+tableInformationBean.getSourceSchemaName()+"].[Reconciliation](").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[SlNo] [int] IDENTITY(1,1) NOT NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[Category] [varchar](50) NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[TableName] [varchar](50) NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[TargetTableName] [varchar](50) NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[SourceCount] [int] NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[TargetCount] [int] NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[ErrorCount] [int] NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[StatusFlag] [varchar](5) NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[StartTime] [datetime] NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[EndTime] [datetime] NULL").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(") ON [PRIMARY]").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("GO").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
        	//Create Reconciliation_Temp In Staging DB
        	stagingFileContentsBuffer.append("CREATE TABLE ["+tableInformationBean.getSourceSchemaName()+"].[Reconciliation_Temp](").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[SlNo] [int] IDENTITY(1,1) NOT NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[Category] [varchar](50) NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[TableName] [varchar](50) NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[TargetTableName] [varchar](50) NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[SourceCount] [int] NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[TargetCount] [int] NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[ErrorCount] [int] NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[StatusFlag] [varchar](5) NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[StartTime] [datetime] NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[EndTime] [datetime] NULL").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(") ON [PRIMARY]").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("GO").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
        	//Create ReplicationErrorLog In Staging DB
        	stagingFileContentsBuffer.append("CREATE TABLE ["+tableInformationBean.getSourceSchemaName()+"].[ReplicationErrorLog](").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("ErrorDateTime datetime NOT NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("ErrorSource nvarchar(100) NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("ErrorKey nvarchar(60) NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("ErrorMessage nvarchar(200) NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("InputXML nvarchar(max) NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("DBUserName nvarchar(20) NOT NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("DBDateTime datetime NOT NULL);").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("GO").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("ALTER TABLE "+tableInformationBean.getSourceSchemaName()+".ReplicationErrorLog ADD  CONSTRAINT DF_ReplicationErrorLog_DBUserName  DEFAULT (suser_sname()) FOR DBUserName").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("GO").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("ALTER TABLE "+tableInformationBean.getSourceSchemaName()+".ReplicationErrorLog ADD  CONSTRAINT DF_ReplicationErrorLog_DBDateTime  DEFAULT (getdate()) FOR DBDateTime").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("GO").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
        	//Create ReplicationTimeLog In Staging DB
        	stagingFileContentsBuffer.append("CREATE TABLE ["+tableInformationBean.getSourceSchemaName()+"].[ReplicationTimeLog](").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[LogId] [numeric](11, 0) IDENTITY(1,1) NOT NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[RecordId] [numeric](11, 0) NOT NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[ProcessingInitTS] [nvarchar](26) NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[ProcessingStartTS] [nvarchar](26) NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[RecReplicationTS] [nvarchar](26) NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[RecRegisterUpdateTS] [nvarchar](26) NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[ReplUpdateStartTS] [nvarchar](26) NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[ReplUpdateEndTS] [nvarchar](26) NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[TS3] [nvarchar](26) NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[TS4] [nvarchar](26) NULL,").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[CreatedDateTime] [datetime] NULL);").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("GO").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("ALTER TABLE "+tableInformationBean.getSourceSchemaName()+".[ReplicationTimeLog] ADD  DEFAULT (getdate()) FOR [CreatedDateTime]").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("GO").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	
         	//SP SPInsertStoredProcedureErrorLog
         	stagingFileContentsBuffer.append("CREATE PROCEDURE "+tableInformationBean.getSourceSchemaName()+".[SPInsertStoredProcedureErrorLog](").append(lineSeparator);
         	stagingFileContentsBuffer.append("@StoreProcedureName Varchar(50),").append(lineSeparator);
         	stagingFileContentsBuffer.append("@ErrorNumber NVarchar(60),").append(lineSeparator);
         	stagingFileContentsBuffer.append("@ErrorMessage NVarchar(4000)").append(lineSeparator);
         	stagingFileContentsBuffer.append(")").append(lineSeparator);
         	stagingFileContentsBuffer.append("AS").append(lineSeparator);
         	stagingFileContentsBuffer.append("Begin Try").append(lineSeparator);
         	stagingFileContentsBuffer.append("Insert Into "+tableInformationBean.getSourceSchemaName()+".DFCStoredProcedureErrorLog(StoredProcedureName,ErrorNumber,ErrorMessage,ErrorTimeStamp)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Values (@StoreProcedureName,@ErrorNumber,@ErrorMessage,Getdate())").append(lineSeparator);
         	stagingFileContentsBuffer.append("End Try").append(lineSeparator);
         	stagingFileContentsBuffer.append("Begin Catch").append(lineSeparator);
         	stagingFileContentsBuffer.append("Insert Into "+tableInformationBean.getSourceSchemaName()+".DFCStoredProcedureErrorLog(StoredProcedureName,ErrorNumber,ErrorMessage,ErrorTimeStamp)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Values ('SPInsertStoredProcedureErrorLog',ERROR_NUMBER(),ERROR_MESSAGE(),GetDate())").append(lineSeparator);
         	stagingFileContentsBuffer.append("End Catch").append(lineSeparator);
         	stagingFileContentsBuffer.append(" END CATCH ").append(lineSeparator);
         	stagingFileContentsBuffer.append("END").append(lineSeparator);
        	stagingFileContentsBuffer.append("GO").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	
         	
        	//Create SPInsertReplicationErrorLog Stored Procedure In Staging DB
        	stagingFileContentsBuffer.append("CREATE PROCEDURE "+tableInformationBean.getSourceSchemaName()+".[SPInsertReplicationErrorLog](").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("@ErrorDateTime           NVARCHAR(19)").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(",@ErrorSource             NVARCHAR(100)").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(",@ErrorKey                NVARCHAR(60)").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(",@ErrorMessage            NVARCHAR(200)").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(",@InputXML              NVARCHAR(MAX)     ").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(",@o_STATUSFLAG          NVARCHAR(2)     = NULL OUT /* 'NG' FOR ERROR 'OK' FOR SUCCESS */").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(",@o_ERRORCODE           NVARCHAR(25)    = NULL OUT").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(",@o_ERRORDESCRIPTION    NVARCHAR(150)   = NULL OUT)").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("AS").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("BEGIN").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("SET NOCOUNT ON").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("BEGIN TRY").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("BEGIN").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("INSERT INTO "+tableInformationBean.getSourceSchemaName()+".[ReplicationErrorLog] ").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("(").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("[ErrorDateTime]").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(",[ErrorSource]").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(",[ErrorKey]").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(",[ErrorMessage]").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(",[InputXML]").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(") ").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("VALUES").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("(").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("@ErrorDateTime").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(",@ErrorSource").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(",@ErrorKey").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(",@ErrorMessage").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(",@InputXML").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(")").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("END").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("SET @o_STATUSFLAG = 'OK'").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("END TRY").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("BEGIN CATCH").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("SET @o_STATUSFLAG       = 'NG'").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("SET @o_ERRORCODE        = ERROR_NUMBER()").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("SET @o_ERRORDESCRIPTION = ERROR_MESSAGE()  ").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("END CATCH").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("SET NOCOUNT OFF").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("END").append(lineSeparator) ;
        	stagingFileContentsBuffer.append("GO").append(lineSeparator) ;
        	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
        	//Create SPInsertReplicationTimeLog Stored Procedure In Staging DB       
         	
        	stagingFileContentsBuffer.append("CREATE PROCEDURE ["+tableInformationBean.getSourceSchemaName()+".[SPInsertReplicationTimeLog]").append(lineSeparator);
        	stagingFileContentsBuffer.append("(    @i_RecordId   NUMERIC(11,0)").append(lineSeparator);
        	stagingFileContentsBuffer.append("    ,@i_ProcessingInitTS        NVARCHAR(26) = NULL").append(lineSeparator);
        	stagingFileContentsBuffer.append("    ,@i_ProcessingStartTS       NVARCHAR(26) = NULL").append(lineSeparator);
        	stagingFileContentsBuffer.append("    ,@i_RecReplicationTS        NVARCHAR(26) = NULL").append(lineSeparator);
        	stagingFileContentsBuffer.append("    ,@i_RecRegisterUpdateTS     NVARCHAR(26) = NULL").append(lineSeparator);
        	stagingFileContentsBuffer.append("    ,@i_ReplUpdateStartTS       NVARCHAR(26) = NULL").append(lineSeparator);
        	stagingFileContentsBuffer.append("    ,@i_ReplUpdateEndTS  NVARCHAR(26) = NULL").append(lineSeparator);
        	stagingFileContentsBuffer.append("    ,@i_TS3  NVARCHAR(26) = NULL").append(lineSeparator);
        	stagingFileContentsBuffer.append("    ,@i_TS4  NVARCHAR(26) = NULL").append(lineSeparator);
        	stagingFileContentsBuffer.append(",@RecordsNotReplicatedNVarchar(3000)=null").append(lineSeparator);
        	stagingFileContentsBuffer.append(",@o_FLAG  NVARCHAR(10)    = NULL OUT").append(lineSeparator);
        	stagingFileContentsBuffer.append(",@o_ERRORCODE  NVARCHAR(25)    = NULL OUT").append(lineSeparator);
        	stagingFileContentsBuffer.append(",@o_ERRORDESCRIPTION      NVARCHAR(max)   = NULL OUT  ").append(lineSeparator);
        	stagingFileContentsBuffer.append(")").append(lineSeparator);
        	stagingFileContentsBuffer.append("AS").append(lineSeparator);
        	stagingFileContentsBuffer.append("BEGIN   ").append(lineSeparator);
        	stagingFileContentsBuffer.append(" SET NOCOUNT ON").append(lineSeparator);
        	stagingFileContentsBuffer.append(" DECLARE @l_TransactionDateTime  DATETIME = GETDATE()").append(lineSeparator);
        	stagingFileContentsBuffer.append(" BEGIN TRY").append(lineSeparator);
        	stagingFileContentsBuffer.append("   INSERT INTO STAGING.[ReplicationTimeLog]").append(lineSeparator);
        	stagingFileContentsBuffer.append("           ([RecordId]").append(lineSeparator);
        	stagingFileContentsBuffer.append("           ,[ProcessingInitTS]").append(lineSeparator);
        	stagingFileContentsBuffer.append("           ,[ProcessingStartTS]").append(lineSeparator);
        	stagingFileContentsBuffer.append("           ,[RecReplicationTS]").append(lineSeparator);
        	stagingFileContentsBuffer.append("           ,[RecRegisterUpdateTS]").append(lineSeparator);
        	stagingFileContentsBuffer.append("           ,[ReplUpdateStartTS]").append(lineSeparator);
        	stagingFileContentsBuffer.append("           ,[ReplUpdateEndTS]").append(lineSeparator);
        	stagingFileContentsBuffer.append("           ,[TS3]").append(lineSeparator);
        	stagingFileContentsBuffer.append("           ,[TS4]").append(lineSeparator);
        	stagingFileContentsBuffer.append("   )").append(lineSeparator);
        	stagingFileContentsBuffer.append("     VALUES").append(lineSeparator);
        	stagingFileContentsBuffer.append("           (@i_RecordId").append(lineSeparator);
        	stagingFileContentsBuffer.append("   ,@i_ProcessingInitTS").append(lineSeparator);
        	stagingFileContentsBuffer.append("   ,@i_ProcessingStartTS").append(lineSeparator);
        	stagingFileContentsBuffer.append("   ,@i_RecReplicationTS").append(lineSeparator);
        	stagingFileContentsBuffer.append("   ,@i_RecRegisterUpdateTS").append(lineSeparator);
        	stagingFileContentsBuffer.append("   ,@i_ReplUpdateStartTS").append(lineSeparator);
        	stagingFileContentsBuffer.append("   ,@i_ReplUpdateEndTS").append(lineSeparator);
        	stagingFileContentsBuffer.append("   ,@i_TS3").append(lineSeparator);
        	stagingFileContentsBuffer.append("   ,@i_TS4").append(lineSeparator);
        	stagingFileContentsBuffer.append("   )").append(lineSeparator);
        	stagingFileContentsBuffer.append("  SET @o_FLAG             = 'OK'").append(lineSeparator);
        	stagingFileContentsBuffer.append("  Set @RecordsNotReplicated= 'Update STAGING.DFCReconciliation Set ReplicationUpdateStatus=Null Where BufferTableName='''+Replace(@RecordsNotReplicated,'|',''' and BufferSequenceNumber In (')+')'").append(lineSeparator);
        	stagingFileContentsBuffer.append("  Exec(@RecordsNotReplicated)").append(lineSeparator);
        	stagingFileContentsBuffer.append(" END TRY").append(lineSeparator);
        	stagingFileContentsBuffer.append(" BEGIN CATCH").append(lineSeparator);
        	stagingFileContentsBuffer.append("   SET @o_FLAG             = 'NG'").append(lineSeparator);
        	stagingFileContentsBuffer.append("   SET @o_ERRORCODE        = ERROR_NUMBER()").append(lineSeparator);
        	stagingFileContentsBuffer.append("   SET @o_ERRORDESCRIPTION = ERROR_MESSAGE()").append(lineSeparator);
        	stagingFileContentsBuffer.append(" END CATCH").append(lineSeparator);
        	stagingFileContentsBuffer.append(" SET NOCOUNT OFF; ").append(lineSeparator);
        	stagingFileContentsBuffer.append("END").append(lineSeparator);
        	stagingFileContentsBuffer.append("GO").append(lineSeparator);
        	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
        	
         	//CREATE SPMANAGEREPLICATION STORED PROCEDURE IN STAING DB
         	/*
         	stagingFileContentsBuffer.append("CREATE PROCEDURE "+tableInformationBean.getSourceSchemaName()+".[SPManageReconciliation]").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("(    @o_FLAG                NVARCHAR(10)    = NULL OUT").append(lineSeparator) ;
         	stagingFileContentsBuffer.append(",@o_ERRORCODE           NVARCHAR(25)    = NULL OUT").append(lineSeparator) ;
         	stagingFileContentsBuffer.append(",@o_ERRORDESCRIPTION    NVARCHAR(max)   = NULL OUT  ").append(lineSeparator) ;
         	stagingFileContentsBuffer.append(")").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("AS").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("BEGIN   ").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("SET NOCOUNT ON").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("SET XACT_ABORT ON").append(lineSeparator) ;
         	stagingFileContentsBuffer.append(" ").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("DECLARE @l_TransactionDateTime  DATETIME = GETDATE()").append(lineSeparator) ;
         	stagingFileContentsBuffer.append(",@l_REPLICATEDCOUNT NUMERIC(5,0) = 0").append(lineSeparator) ;
         	stagingFileContentsBuffer.append(",@result int").append(lineSeparator) ;
         	stagingFileContentsBuffer.append(",@ReconBatchSize int").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("BEGIN TRAN").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("BEGIN TRY").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("   EXEC @result = sp_getapplock @Resource = '"+tableInformationBean.getSourceSchemaName()+".DFCReconciliation', ").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("   @LockMode = 'Exclusive';").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("   IF @result<>0").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("BEGIN").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("ROLLBACK TRAN").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("RETURN").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("END").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("   ELSE").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("       BEGIN").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("      SELECT @l_REPLICATEDCOUNT = COUNT(ReplicationStatus) FROM ["+tableInformationBean.getSourceSchemaName()+"].[DFCReconciliation] ").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("  WHERE ReplicationStatus IN (2,4,5)").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("  AND ReplicationUpdateStatus IS NULL").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("          ").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("  IF (@l_REPLICATEDCOUNT > 0) ").append(lineSeparator) ;
         	stagingFileContentsBuffer.append(" BEGIN").append(lineSeparator) ;
         	stagingFileContentsBuffer.append(" Select ReconciliationBatchSize Into @ReconBatchSize From ").append(tableInformationBean.getSourceSchemaName()).append(".DFCParameterMaster") .append(lineSeparator) ;
         	stagingFileContentsBuffer.append("--  DFA4NB,DFADST,DFEGTX --#StagingReplicationRegister").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("SELECT TOP (@ReconBatchSize) BufferSequenceNumber, ReplicationStatus, ReplicationDateTime, BufferTableName  ").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("INTO #DFCReconciliation ").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("FROM ["+tableInformationBean.getSourceSchemaName()+"].[DFCReconciliation] ").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("WHERE ReplicationStatus IN (2,4,5)").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("AND ReplicationUpdateStatus IS NULL").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("ORDER BY BufferSequenceNumber").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("MERGE ["+tableInformationBean.getSourceSchemaName()+"].[DFCReconciliation] AS RECON").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("USING (SELECT DISTINCT BufferSequenceNumber FROM #DFCReconciliation) AS MID").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("ON RECON.BufferSequenceNumber=MID.BufferSequenceNumber").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("WHEN MATCHED THEN").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("UPDATE SET RECON.ReplicationUpdateStatus = 1;").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("--UPDATE ["+tableInformationBean.getSourceSchemaName()+"].[DFCReconciliation]").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("--WHERE BufferSequenceNumber IN (SELECT BufferSequenceNumber FROM #DFCReconciliation)").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("/*  Code Added And Commented By AJ83993 As Testing is Going On").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("Insert Into ["+tableInformationBean.getSourceSchemaName()+"].[DFCReconciliationArchive](BufferSequenceNumber, StagingId, StagingTableName, BufferTableName, ").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("ReplicationStatus, ReplicationUpdateStatus, ReplicationDateTime)").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("Select BufferSequenceNumber, StagingId, StagingTableName, BufferTableName, ReplicationStatus, ReplicationUpdateStatus, ReplicationDateTime").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("From ["+tableInformationBean.getSourceSchemaName()+"].[DFCReconciliation] Where Isnull(ReplicationUpdateStatus,0)=1").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("Delete From  ["+tableInformationBean.getSourceSchemaName()+"].[DFCReconciliation] Where Isnull(ReplicationUpdateStatus,0)=1").append(lineSeparator) ;

         	stagingFileContentsBuffer.append("").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("EXEC @result = sp_releaseapplock @Resource = '"+tableInformationBean.getSourceSchemaName()+".DFCReconciliation' ").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("                COMMIT TRANSACTION;").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("SELECT BufferSequenceNumber AS DFA4NB, ReplicationStatus AS DFADST, ").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("ReplicationDateTime AS DFEGTX, BufferTableName AS BFTBNM ").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("FROM #DFCReconciliation").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("        --DROP TABLE  #DFCReconciliation").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("        SET @o_FLAG = 'OK'").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("        SET @o_ERRORDESCRIPTION = 'Replicated record batch available for Update'").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("        END").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("  ELSE").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("BEGIN ").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("EXEC @result = sp_releaseapplock @Resource = '"+tableInformationBean.getSourceSchemaName()+".DFCReconciliation' ").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("ROLLBACK TRAN").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("SET @o_FLAG = 'NG'").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("SET @o_ERRORDESCRIPTION = 'Wait till Replicated record batch is available for Update'").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("END").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("END").append(lineSeparator) ;
         	stagingFileContentsBuffer.append(" END TRY").append(lineSeparator) ;
         	stagingFileContentsBuffer.append(" ").append(lineSeparator) ;
         	stagingFileContentsBuffer.append(" BEGIN CATCH").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("   SET @o_FLAG             = 'NG'").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("   SET @o_ERRORCODE        = ERROR_NUMBER()").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("   SET @o_ERRORDESCRIPTION = ERROR_MESSAGE()").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("   IF @result=0").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("     BEGIN").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("  EXEC @result = sp_releaseapplock @Resource = '"+tableInformationBean.getSourceSchemaName()+".DFCReconciliation'").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("  ROLLBACK TRAN").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("END").append(lineSeparator) ;
         	stagingFileContentsBuffer.append(" END CATCH ").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("END").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("GO").append(lineSeparator) ;
         	stagingFileContentsBuffer.append("").append(lineSeparator) ;
         	*/
         	//SP MANAGE NEW CHANGE
         	
         	stagingFileContentsBuffer.append("CREATE PROCEDURE ["+tableInformationBean.getSourceSchemaName()+"].[SPManageReconciliation]").append(lineSeparator);
         	stagingFileContentsBuffer.append("( ").append(lineSeparator);
         	stagingFileContentsBuffer.append(" @o_FLAG                NVARCHAR(10)    = NULL OUT").append(lineSeparator);
         	stagingFileContentsBuffer.append(",@o_ERRORCODE           NVARCHAR(25)    = NULL OUT").append(lineSeparator);
         	stagingFileContentsBuffer.append(",@o_ERRORDESCRIPTION    NVARCHAR(max)   = NULL OUT  ").append(lineSeparator);
         	stagingFileContentsBuffer.append(")").append(lineSeparator);
         	stagingFileContentsBuffer.append("AS").append(lineSeparator);
         	stagingFileContentsBuffer.append("BEGIN   ").append(lineSeparator);
         	stagingFileContentsBuffer.append("SET NOCOUNT ON").append(lineSeparator);
         	stagingFileContentsBuffer.append("SET XACT_ABORT ON").append(lineSeparator);
         	stagingFileContentsBuffer.append("DECLARE @l_TransactionDateTime  DATETIME = GETDATE() ,@l_REPLICATEDCOUNT NUMERIC(5,0) = 0,@result int").append(lineSeparator);
         	stagingFileContentsBuffer.append("BEGIN TRY").append(lineSeparator);
         	stagingFileContentsBuffer.append("  SELECT @l_REPLICATEDCOUNT = COUNT(ReplicationStatus) FROM [STAGING].[DFCReconciliation] ").append(lineSeparator);
         	stagingFileContentsBuffer.append("  WHERE ReplicationStatus IN (2,4,5)  AND ReplicationUpdateStatus IS NULL").append(lineSeparator);
         	stagingFileContentsBuffer.append("").append(lineSeparator);
         	stagingFileContentsBuffer.append("  IF (@l_REPLICATEDCOUNT > 0) ").append(lineSeparator);
         	stagingFileContentsBuffer.append(" BEGIN").append(lineSeparator);
         	stagingFileContentsBuffer.append("DECLARE @TMP TABLE(DFA4NB NUMERIC(32,2),DFADST NUMERIC(2,0),DFEGTX DATETIME,BFTBNM NVARCHAR(50))").append(lineSeparator);
         	stagingFileContentsBuffer.append("UPDATE TOP (400) [STAGING].[DFCReconciliation] SET  ReplicationUpdateStatus = 1 OUTPUT").append(lineSeparator);
         	stagingFileContentsBuffer.append("INSERTED.BufferSequenceNumber,INSERTED.ReplicationStatus,INSERTED.ReplicationDateTime,").append(lineSeparator);
         	stagingFileContentsBuffer.append("INSERTED.BufferTableName INTO @TMP").append(lineSeparator);
         	stagingFileContentsBuffer.append("WHERE ReplicationStatus IN (2,4,5) AND ReplicationUpdateStatus IS NULL").append(lineSeparator);
         	stagingFileContentsBuffer.append("").append(lineSeparator);
         	stagingFileContentsBuffer.append("SELECT * FROM @TMP").append(lineSeparator);
         	stagingFileContentsBuffer.append("").append(lineSeparator);
         	stagingFileContentsBuffer.append("        SET @o_FLAG = 'OK'").append(lineSeparator);
         	stagingFileContentsBuffer.append("        SET @o_ERRORDESCRIPTION = 'Replicated record batch available for Update'").append(lineSeparator);
         	stagingFileContentsBuffer.append("END").append(lineSeparator);
         	stagingFileContentsBuffer.append("END TRY").append(lineSeparator);
         	stagingFileContentsBuffer.append("BEGIN CATCH").append(lineSeparator);
         	stagingFileContentsBuffer.append("   SET @o_FLAG             = 'NG'").append(lineSeparator);
         	stagingFileContentsBuffer.append("   SET @o_ERRORCODE        = ERROR_NUMBER()").append(lineSeparator);
         	stagingFileContentsBuffer.append("   SET @o_ERRORDESCRIPTION = ERROR_MESSAGE()").append(lineSeparator);
         	stagingFileContentsBuffer.append("   Exec "+tableInformationBean.getSourceSchemaName()+".SPInsertStoredProcedureErrorLog '["+tableInformationBean.getSourceSchemaName()+"].[SPManageReconciliation]',@o_ERRORCODE,@o_ERRORDESCRIPTION").append(lineSeparator);
         	stagingFileContentsBuffer.append(" END CATCH ").append(lineSeparator);
         	stagingFileContentsBuffer.append("END").append(lineSeparator);
         	stagingFileContentsBuffer.append("GO").append(lineSeparator);
			stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	
         	
        	//Create Function FNCDFCConvertDateCYYMMDD In Staging DB  
			stagingFileContentsBuffer.append("USE ["+tableInformationBean.getSourceDatabaseName()+"]").append(lineSeparator);
			stagingFileContentsBuffer.append("GO").append(lineSeparator);
			stagingFileContentsBuffer.append("CREATE FUNCTION ["+tableInformationBean.getSourceSchemaName()+"].[FNCDFCConvertDateCYYMMDD]").append(lineSeparator);
			stagingFileContentsBuffer.append("( @SourceDate DECIMAL(7,0))").append(lineSeparator);
			stagingFileContentsBuffer.append("RETURNS Date").append(lineSeparator);
			stagingFileContentsBuffer.append("AS").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @ResultDate DATE = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @DateStringConverted VARCHAR(10)").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @DateString VARCHAR(10)").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @DateStringConverted = CAST(@SourceDate AS VARCHAR)").append(lineSeparator);
			stagingFileContentsBuffer.append("IF ISNULL(@DateStringConverted,'A') = 'A'").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ResultDate = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("RETURN @ResultDate").append(lineSeparator);			
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("IF (@DateStringConverted = 0)").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ResultDate = '01/01/1900'").append(lineSeparator);
			stagingFileContentsBuffer.append("RETURN @ResultDate").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @DateStringConverted = RIGHT('0000000' + CONVERT(VARCHAR(7),@SourceDate), 7)").append(lineSeparator);
			stagingFileContentsBuffer.append("SELECT @DateString = (CASE WHEN @DateStringConverted LIKE '_999999' THEN '12-31-2099'").append(lineSeparator);
			stagingFileContentsBuffer.append("WHEN @DateStringConverted LIKE '000000_' THEN '01-01-1900'").append(lineSeparator);
			stagingFileContentsBuffer.append("ELSE CAST(LEFT(@DateStringConverted,1) + 19 AS VARCHAR) + CAST(SUBSTRING(@DateStringConverted, 2,6) AS VARCHAR)").append(lineSeparator);
			stagingFileContentsBuffer.append("END)").append(lineSeparator);
			stagingFileContentsBuffer.append("IF (ISDATE(@DateString) = 1)").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ResultDate = CAST(@DateString AS DATE)").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("RETURN @ResultDate").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("GO").append(lineSeparator);
			stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
			
        	//Create Function FNCDFCConvertDateCYYMM In Staging DB
			stagingFileContentsBuffer.append(lineSeparator).append(lineSeparator);
			stagingFileContentsBuffer.append("CREATE FUNCTION ["+tableInformationBean.getSourceSchemaName()+"].[FNCDFCConvertDateCYYMM]").append(lineSeparator);
			stagingFileContentsBuffer.append("( @SourceDate DECIMAL(5,0))").append(lineSeparator);
			stagingFileContentsBuffer.append("RETURNS Date").append(lineSeparator);
			stagingFileContentsBuffer.append("AS").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @ResultDate DATE = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @DateStringConverted VARCHAR(10)").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @DateString VARCHAR(10)").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @DateStringConverted = CAST(@SourceDate AS VARCHAR)").append(lineSeparator);
			stagingFileContentsBuffer.append("IF ISNULL(@DateStringConverted,'A') = 'A'").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ResultDate = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("RETURN @ResultDate").append(lineSeparator);			
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("IF (@DateStringConverted = 0)").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ResultDate = '01/01/1900'").append(lineSeparator);
			stagingFileContentsBuffer.append("RETURN @ResultDate").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @DateStringConverted = RIGHT('00000' + CONVERT(VARCHAR(5),@SourceDate), 5)").append(lineSeparator);
			stagingFileContentsBuffer.append("SELECT @DateString = (CASE WHEN @DateStringConverted LIKE '_9999' THEN '12-31-2099'").append(lineSeparator);
			stagingFileContentsBuffer.append("WHEN @DateStringConverted LIKE '0000_' THEN '01-01-1900'").append(lineSeparator);
			stagingFileContentsBuffer.append("ELSE CAST(LEFT(@DateStringConverted,1) + 19 AS VARCHAR) + SUBSTRING(@DateStringConverted, 2,4) + '01'").append(lineSeparator);
			stagingFileContentsBuffer.append("END)").append(lineSeparator);
			stagingFileContentsBuffer.append("IF (ISDATE(@DateString) = 1)").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ResultDate = CAST(@DateString AS DATE)").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("RETURN @ResultDate").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("GO").append(lineSeparator);
			stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
        	//Create Function FNCDFCConvertTimeHHMMSS In Staging DB
			stagingFileContentsBuffer.append(lineSeparator).append(lineSeparator);
			stagingFileContentsBuffer.append("CREATE FUNCTION ["+tableInformationBean.getSourceSchemaName()+"].[FNCDFCConvertTimeHHMMSS]").append(lineSeparator);
			stagingFileContentsBuffer.append("( @SourceTime DECIMAL(6,0))").append(lineSeparator);
			stagingFileContentsBuffer.append("RETURNS Time").append(lineSeparator);
			stagingFileContentsBuffer.append("AS").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @ResultTime Time = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @TimeStringConverted VARCHAR(10)").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @TimeString VARCHAR(10)").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @TimeString = CAST(@SourceTime AS VARCHAR)").append(lineSeparator);
			stagingFileContentsBuffer.append("IF (ISNULL(@TimeString,'A') = 'A')").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("RETURN @ResultTime").append(lineSeparator);			
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @TimeStringConverted = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @TimeStringConverted = RIGHT('000000' + CONVERT(VARCHAR(6),@SourceTime), 6)").append(lineSeparator);
			stagingFileContentsBuffer.append("IF(SUBSTRING(@TimeStringConverted,1,2)< '24' AND SUBSTRING(@TimeStringConverted,3,2)< '60' AND SUBSTRING(@TimeStringConverted,5,2)< '60')").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SELECT @TimeString = SUBSTRING(@TimeStringConverted,1,2) + ':' + SUBSTRING(@TimeStringConverted,3,2) + ':' + SUBSTRING(@TimeStringConverted,5,2)").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ResultTime = CAST(@TimeString AS TIME)").append(lineSeparator);
			stagingFileContentsBuffer.append("END	").append(lineSeparator);
			stagingFileContentsBuffer.append("RETURN @ResultTime").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("GO").append(lineSeparator);
			stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	
         	
//Stored Procedure to Dump XML
         	/*
         	stagingFileContentsBuffer.append("Create PROCEDURE "+tableInformationBean.getSourceSchemaName()+".[SPEXECREQUEST_SHORT](@XmlBatch NVarchar(Max))").append(lineSeparator);
         	stagingFileContentsBuffer.append("AS").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare @BufferSequence Varchar(30)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare @SourceFileName Varchar(10)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare @SourceData Varchar(Max)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare @BufferTableName Varchar(10)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare @SepaChar NVarchar(2)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare @SOURCETRANSACTIONCODE Varchar(1)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare @PRIORITY Varchar(10)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare @AS400TimeStamp Varchar(26)").append(lineSeparator);
         	stagingFileContentsBuffer.append("DECLARE @XML xml").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare @CurTimeStamp Varchar(26)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare @query NVarchar(Max)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Begin Try").append(lineSeparator);
         	stagingFileContentsBuffer.append("set @XML=@XmlBatch").append(lineSeparator);
         	stagingFileContentsBuffer.append("Set @CurTimeStamp=Convert(varchar(26),Getdate(),120)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare LoopCur Cursor Local Read_only for ").append(lineSeparator);
         	stagingFileContentsBuffer.append("SELECT ").append(lineSeparator);
         	stagingFileContentsBuffer.append("x.data.value('BS[1]','int'),").append(lineSeparator);
         	stagingFileContentsBuffer.append("x.data.value('ST[1]','Varchar(10)'),").append(lineSeparator);
         	stagingFileContentsBuffer.append("x.data.value('SD[1]','Varchar(max)'),").append(lineSeparator);
         	stagingFileContentsBuffer.append("x.data.value('BT[1]','Varchar(10)'),").append(lineSeparator);
         	stagingFileContentsBuffer.append("x.data.value('S[1]','NVarchar(10)'),").append(lineSeparator);
         	stagingFileContentsBuffer.append("x.data.value('TC[1]','NVarchar(1)'),").append(lineSeparator);
         	stagingFileContentsBuffer.append("1,").append(lineSeparator);
         	stagingFileContentsBuffer.append("GETDATE()").append(lineSeparator);
         	stagingFileContentsBuffer.append("FROM ").append(lineSeparator);
         	stagingFileContentsBuffer.append("@XML.nodes('/Row') as x(data)").append(lineSeparator);
         	stagingFileContentsBuffer.append("--where x.data.value('SOURCEFILENAME[1]','Varchar(10)')='OORDLIN'").append(lineSeparator);
         	stagingFileContentsBuffer.append("Open LoopCur").append(lineSeparator);
         	stagingFileContentsBuffer.append("Fetch Next From LoopCur Into @BufferSequence,@SourceFileName,@SourceData,@BufferTableName,@SepaChar,@SOURCETRANSACTIONCODE,@PRIORITY,@AS400TimeStamp").append(lineSeparator);
         	stagingFileContentsBuffer.append("While @@FETCH_STATUS=0").append(lineSeparator);
         	stagingFileContentsBuffer.append("Begin").append(lineSeparator);
         	stagingFileContentsBuffer.append("Set @AS400TimeStamp=@CurTimeStamp").append(lineSeparator);
         	stagingFileContentsBuffer.append("Set @SourceData=Replace(@SourceData,'''','''''')").append(lineSeparator);
         	stagingFileContentsBuffer.append("Set @SourceData=Substring(@SourceData,0,len(@SourceData))").append(lineSeparator);
         	stagingFileContentsBuffer.append("Set @SourceData=Replace(@SourceData,'',''',''')").append(lineSeparator);
         	stagingFileContentsBuffer.append("Set @SourceData=@SourceData + ''','''+@SOURCETRANSACTIONCODE+''','''+@AS400TimeStamp+''','''+@AS400TimeStamp+''','''+@PRIORITY+''','''+@BufferSequence+''','''+@BufferTableName+''','''','''','''").append(lineSeparator);
         	stagingFileContentsBuffer.append("Set @query='Exec STAGING.SPInsertSTG_'+@SourceFileName +' '  +''''+@SourceData+''''").append(lineSeparator);
         	stagingFileContentsBuffer.append("Exec (@query)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Fetch Next From LoopCur Into @BufferSequence,@SourceFileName,@SourceData,@BufferTableName,@SepaChar,@SOURCETRANSACTIONCODE,@PRIORITY,@AS400TimeStamp").append(lineSeparator);
         	stagingFileContentsBuffer.append("End").append(lineSeparator);
         	stagingFileContentsBuffer.append("Close LoopCur").append(lineSeparator);
         	stagingFileContentsBuffer.append("Deallocate LoopCur").append(lineSeparator);
         	stagingFileContentsBuffer.append("End Try").append(lineSeparator);
         	stagingFileContentsBuffer.append("Begin Catch").append(lineSeparator);
         	stagingFileContentsBuffer.append("").append(lineSeparator);
         	stagingFileContentsBuffer.append("End Catch").append(lineSeparator);
         	stagingFileContentsBuffer.append("GO").append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);

         	*/
         	
         	stagingFileContentsBuffer.append("CREATE PROCEDURE ["+tableInformationBean.getSourceSchemaName()+"].[SPExecuteXMLBatch](@iXmlBatch nVarchar(Max),@LogInstrument nvarchar(1000))").append(lineSeparator);
         	stagingFileContentsBuffer.append("AS").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare @BufferSequence Varchar(30)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare @SourceFileName Varchar(10)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare @SourceData Varchar(Max)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare @BufferTableName Varchar(10)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare @SepaChar NVarchar(2)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare @SOURCETRANSACTIONCODE Varchar(1)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare @PRIORITY Varchar(10)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare @AS400SourceTimeStamp Varchar(23)").append(lineSeparator);
         	stagingFileContentsBuffer.append("DECLARE @XML xml").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare @CurTimeStamp Varchar(26)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare @query NVarchar(Max)").append(lineSeparator);
         	stagingFileContentsBuffer.append("declare @BufferPickupTimeStamp Varchar(23)").append(lineSeparator);
         	stagingFileContentsBuffer.append("DECLARE @o_ERRORCODE VARCHAR(30)").append(lineSeparator);
         	stagingFileContentsBuffer.append("DECLARE @o_ERRORDESCRIPTION VARCHAR(4000)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Begin Try").append(lineSeparator);
         	stagingFileContentsBuffer.append("--Set @LogInstrument=@LogInstrument+ '|' +right(convert(varchar(29),getdate(),120),8)").append(lineSeparator);
         	stagingFileContentsBuffer.append("set @XML=@iXmlBatch").append(lineSeparator);
         	stagingFileContentsBuffer.append("Set @CurTimeStamp=Convert(varchar(26),Getdate(),120)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Declare LoopCur Cursor Local Read_only for ").append(lineSeparator);
         	stagingFileContentsBuffer.append("SELECT ").append(lineSeparator);
         	stagingFileContentsBuffer.append("x.data.value('BS[1]','int'),").append(lineSeparator);
         	stagingFileContentsBuffer.append("x.data.value('ST[1]','Varchar(10)'),").append(lineSeparator);
         	stagingFileContentsBuffer.append("x.data.value('SD[1]','Varchar(max)'),").append(lineSeparator);
         	stagingFileContentsBuffer.append("x.data.value('(/ResultSet/@BT)[1]', 'Varchar(10)'),").append(lineSeparator);
         	stagingFileContentsBuffer.append("x.data.value('(/ResultSet/@S)[1]', 'NVarchar(10)'),").append(lineSeparator);
         	stagingFileContentsBuffer.append("x.data.value('TC[1]','NVarchar(1)'),").append(lineSeparator);
         	stagingFileContentsBuffer.append("x.data.value('TS[1]','DateTime'),").append(lineSeparator);
         	stagingFileContentsBuffer.append("1,").append(lineSeparator);
         	stagingFileContentsBuffer.append("x.data.value('BPT[1]','DateTime')").append(lineSeparator);
         	stagingFileContentsBuffer.append("FROM ").append(lineSeparator);
         	stagingFileContentsBuffer.append("@XML.nodes('/ResultSet/Row') as x(data)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Open LoopCur").append(lineSeparator);
         	stagingFileContentsBuffer.append("Fetch Next From LoopCur Into @BufferSequence,@SourceFileName,@SourceData,@BufferTableName,@SepaChar,@SOURCETRANSACTIONCODE,@AS400SourceTimeStamp,@PRIORITY,@BufferPickupTimeStamp").append(lineSeparator);
         	stagingFileContentsBuffer.append("While @@FETCH_STATUS=0").append(lineSeparator);
         	stagingFileContentsBuffer.append("Begin").append(lineSeparator);
         	stagingFileContentsBuffer.append("Set @SourceData=Replace(@SourceData,'''','''''')").append(lineSeparator);
         	stagingFileContentsBuffer.append("Set @SourceData=Substring(@SourceData,0,len(@SourceData))").append(lineSeparator);
         	stagingFileContentsBuffer.append("Set @SourceData=Replace(@SourceData,@SepaChar,''',''')").append(lineSeparator);
         	stagingFileContentsBuffer.append("Set @SourceData=@SourceData + ''','''+@SOURCETRANSACTIONCODE+''','''+@BufferPickupTimeStamp+''','''+@AS400SourceTimeStamp+''','''+@PRIORITY+''','''+@BufferSequence+''','''+@BufferTableName+''','''','''','''").append(lineSeparator);
         	stagingFileContentsBuffer.append("Set @query='Exec STAGING.SPInsertSTG_'+@SourceFileName +' '  +''''+@SourceData+''''").append(lineSeparator);
         	stagingFileContentsBuffer.append("Exec (@query)").append(lineSeparator);
         	stagingFileContentsBuffer.append("Fetch Next From LoopCur Into @BufferSequence,@SourceFileName,@SourceData,@BufferTableName,@SepaChar,@SOURCETRANSACTIONCODE,@AS400SourceTimeStamp,@PRIORITY,@BufferPickupTimeStamp").append(lineSeparator);
         	stagingFileContentsBuffer.append("End").append(lineSeparator);
         	stagingFileContentsBuffer.append("Close LoopCur").append(lineSeparator);
         	stagingFileContentsBuffer.append("Deallocate LoopCur").append(lineSeparator);
         	stagingFileContentsBuffer.append("--Set @LogInstrument=@LogInstrument + '|' +right(convert(varchar(29),getdate(),120),8)").append(lineSeparator);
         	stagingFileContentsBuffer.append("--set @LogInstrument=right(convert(varchar(29),@Db2TS,120),8) + '|' +@LogInstrument").append(lineSeparator);
         	stagingFileContentsBuffer.append("--Insert into tmp values(@SepaChar)").append(lineSeparator);
         	stagingFileContentsBuffer.append("End Try").append(lineSeparator);
         	stagingFileContentsBuffer.append("Begin Catch").append(lineSeparator);
         	stagingFileContentsBuffer.append(" SET @o_ERRORCODE        = ERROR_NUMBER()").append(lineSeparator);
         	stagingFileContentsBuffer.append(" SET @o_ERRORDESCRIPTION = ERROR_MESSAGE()").append(lineSeparator);
         	stagingFileContentsBuffer.append(" Exec "+tableInformationBean.getSourceSchemaName()+".SPInsertStoredProcedureErrorLog '["+tableInformationBean.getSourceSchemaName()+"].[SPExecuteXMLBatch]',@o_ERRORCODE,@o_ERRORDESCRIPTION").append(lineSeparator);
         	stagingFileContentsBuffer.append("End Catch").append(lineSeparator);
         	stagingFileContentsBuffer.append("GO").append(lineSeparator);
         	stagingFileContentsBuffer.append("").append(lineSeparator);
         	stagingFileContentsBuffer.append("").append(lineSeparator);

         	
         	
         	
         	
        	//Create DFCError Table In GDC DB   
        	stagingFileContentsBuffer.append("CREATE TABLE ").append(tableInformationBean.getTargetDatabaseName()).append(".").append(tableInformationBean.getTargetSchemaName()).append(".");
        	stagingFileContentsBuffer.append("DFCError(").append(lineSeparator);
        	stagingFileContentsBuffer.append("STG_ID BIGINT NOT NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("TR_TRANSACTION_DATETIME DATETIME NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("StagingTableName VARCHAR(50) NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("ErrorCode VARCHAR(30) NULL,").append(lineSeparator);
        	stagingFileContentsBuffer.append("ErrorDescription VARCHAR(1000) NULL);").append(lineSeparator);
        	stagingFileContentsBuffer.append("GO").append(lineSeparator);
        	
        	
        	
        					
        	//Create Function  FNC_DFC_ConvertDateCYYMM In GDC DB   
        	stagingFileContentsBuffer.append("USE ["+ tableInformationBean.getTargetDatabaseName()+"]").append(lineSeparator);
        	stagingFileContentsBuffer.append("GO").append(lineSeparator);
        	stagingFileContentsBuffer.append("CREATE FUNCTION ["+tableInformationBean.getTargetSchemaName()+"].[FNC_DFC_ConvertDateCYYMM]").append(lineSeparator);
        	stagingFileContentsBuffer.append("( @SourceDate DECIMAL(5,0))").append(lineSeparator);
        	stagingFileContentsBuffer.append("RETURNS @ConvertedTable TABLE (ConvertedDate DATE, ErrorNumber INT,ErrorDescription varchar(1000))").append(lineSeparator);
        	stagingFileContentsBuffer.append("AS").append(lineSeparator);
        	stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
        	stagingFileContentsBuffer.append("DECLARE @ResultDate DATE").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @ErrorMessage VARCHAR(MAX)").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @ErrorNumber INT").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @TextMessage VARCHAR(50)").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @DateStringConverted VARCHAR(10)").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @DateString VARCHAR(10)").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @TextMessage = 'Error in Date conversion - '").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorNumber = 0").append(lineSeparator);			
			stagingFileContentsBuffer.append("SET @ErrorMessage = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("/* Converting input decimal value as string */	").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @DateStringConverted = CAST(@SourceDate AS VARCHAR)").append(lineSeparator);
			stagingFileContentsBuffer.append("/* Check if input is NULL*/").append(lineSeparator);
			stagingFileContentsBuffer.append("IF ISNULL(@DateStringConverted,'A') = 'A'").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ResultDate = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorNumber = 0").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorMessage = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("ELSE").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @DateStringConverted = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @DateStringConverted = RIGHT('00000' + CONVERT(VARCHAR(5),@SourceDate), 5)").append(lineSeparator);
			stagingFileContentsBuffer.append("SELECT @DateString = (CASE WHEN @DateStringConverted like '_9999' THEN '12-31-2099'").append(lineSeparator);
			stagingFileContentsBuffer.append("WHEN @DateStringConverted like '0000_' THEN '01-01-1900'").append(lineSeparator);
			stagingFileContentsBuffer.append("ELSE CAST(LEFT(@DateStringConverted,1) + 19 AS VARCHAR) + SUBSTRING(@DateStringConverted, 2, 4) + '01'").append(lineSeparator);
			stagingFileContentsBuffer.append("END)").append(lineSeparator);
			stagingFileContentsBuffer.append(" /* Check if the input string is proper date.*/").append(lineSeparator);
			stagingFileContentsBuffer.append("IF ISDATE(@DateString) = 0").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorMessage = @TextMessage + CONVERT(VARCHAR,@SourceDate)").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorNumber = 99997").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("ELSE").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ResultDate = CAST(@DateString AS DATE)").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorNumber = 0").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("/*The Converted date, Error number & Error description is stored in the below table, and passed to the calling procedure*/").append(lineSeparator);
			stagingFileContentsBuffer.append("INSERT INTO @ConvertedTable VALUES (@ResultDate,@ErrorNumber,@ErrorMessage)").append(lineSeparator);
			stagingFileContentsBuffer.append("RETURN ").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("GO").append(lineSeparator);

			stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	
         	
         	//cREATE FUNCTION IN GDC
         	stagingFileContentsBuffer.append("CREATE FUNCTION ["+tableInformationBean.getTargetSchemaName()+"].[FNC_DFC_ConvertStringToDecimal]").append(lineSeparator);
         	stagingFileContentsBuffer.append("( @ConversionString NVARCHAR(MAX),").append(lineSeparator);
         	stagingFileContentsBuffer.append("    @Precision int, ").append(lineSeparator);
         	stagingFileContentsBuffer.append("    @Scale int  ").append(lineSeparator);
         	stagingFileContentsBuffer.append(")").append(lineSeparator);
         	stagingFileContentsBuffer.append(" RETURNS @ConvertedTable TABLE (ConvertedDecimal  DECIMAL(18,5), ErrorNumber INT,ErrorDescription varchar(1000))").append(lineSeparator);
         	stagingFileContentsBuffer.append(" As").append(lineSeparator);
         	stagingFileContentsBuffer.append("   BEGIN  ").append(lineSeparator);
         	stagingFileContentsBuffer.append("DECLARE @ErrorMessage VARCHAR(MAX)").append(lineSeparator);
         	stagingFileContentsBuffer.append("DECLARE @ErrorNumber INT").append(lineSeparator);
         	stagingFileContentsBuffer.append("DECLARE @TextMessage VARCHAR(50)").append(lineSeparator);
         	stagingFileContentsBuffer.append("    SET @ConversionString = REPLACE(@ConversionString,' ','')").append(lineSeparator);
         	stagingFileContentsBuffer.append("    SET @ConversionString = REPLACE(@ConversionString,',','')").append(lineSeparator);
         	stagingFileContentsBuffer.append("IF (LEN(@ConversionString) > @Precision+2)").append(lineSeparator);
         	stagingFileContentsBuffer.append("SET @ErrorMessage = 'LENGTH ERROR'").append(lineSeparator);
         	stagingFileContentsBuffer.append("    IF @ConversionString like '%[^0-9.+-]%' SET @ErrorMessage = 'INVALID1' ").append(lineSeparator);
         	stagingFileContentsBuffer.append("    IF @ConversionString like '_%[+-]%' SET @ErrorMessage = 'INVALID3' ").append(lineSeparator);
         	stagingFileContentsBuffer.append("    IF @ConversionString like '[.+-]' SET @ErrorMessage = 'INVALID4' ").append(lineSeparator);
         	stagingFileContentsBuffer.append("    IF @ConversionString like '[+-].' SET @ErrorMessage = 'INVALID5' ").append(lineSeparator);
         	stagingFileContentsBuffer.append("IF @ConversionString NOT like  '%.%' ").append(lineSeparator);
         	stagingFileContentsBuffer.append("set @ConversionString = LEFT(@ConversionString, LEN(@ConversionString)- @Scale) + '.' + RIGHT(@ConversionString,@Scale)").append(lineSeparator);
         	stagingFileContentsBuffer.append("IF  (ISNULL(@ErrorMessage,'') <> '' OR ISNUMERIC(@ConversionString) = 0)").append(lineSeparator);
         	stagingFileContentsBuffer.append("INSERT INTO @ConvertedTable VALUES (NULL,NULL,CASE WHEN ISNULL(@ErrorMessage,'') = '' THEN 'Error' ELSE @ErrorMessage END)").append(lineSeparator);
         	stagingFileContentsBuffer.append("ELSE").append(lineSeparator);
         	stagingFileContentsBuffer.append("INSERT INTO @ConvertedTable VALUES (@ConversionString,@ErrorNumber,@ErrorMessage)").append(lineSeparator);
         	stagingFileContentsBuffer.append("RETURN").append(lineSeparator);
         	stagingFileContentsBuffer.append("END").append(lineSeparator);
         	stagingFileContentsBuffer.append("GO").append(lineSeparator);
         	stagingFileContentsBuffer.append("").append(lineSeparator);
         	

        	//Create Function  FNC_DFC_ConvertDateCYYMMDD In GDC DB			
			stagingFileContentsBuffer.append("CREATE FUNCTION ["+tableInformationBean.getTargetSchemaName()+"].[FNC_DFC_ConvertDateCYYMMDD]").append(lineSeparator);
			stagingFileContentsBuffer.append("( @SourceDate DECIMAL(7,0))").append(lineSeparator);
			stagingFileContentsBuffer.append("RETURNS @ConvertedTable TABLE (ConvertedDate DATE, ErrorNumber INT,ErrorDescription varchar(1000))").append(lineSeparator);
			stagingFileContentsBuffer.append("AS").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @ResultDate DATE").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @ErrorMessage VARCHAR(MAX)").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @ErrorNumber INT").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @TextMessage VARCHAR(50)").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @DateStringConverted VARCHAR(10)").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @DateString VARCHAR(10)").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @TextMessage = 'Error in Date conversion - '").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorNumber = 0").append(lineSeparator);			
			stagingFileContentsBuffer.append("SET @ErrorMessage = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("/* Converting input decimal value as string */	").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @DateStringConverted = CAST(@SourceDate AS VARCHAR)").append(lineSeparator);
			stagingFileContentsBuffer.append("/* Check if input is NULL*/").append(lineSeparator);
			stagingFileContentsBuffer.append("IF ISNULL(@DateStringConverted,'A') = 'A'").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ResultDate = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorNumber = 0").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorMessage = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("ELSE").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @DateStringConverted = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @DateStringConverted = RIGHT('0000000' + CONVERT(VARCHAR(7),@SourceDate), 7)").append(lineSeparator);
			stagingFileContentsBuffer.append("SELECT @DateString = (CASE WHEN @DateStringConverted like '_999999' THEN '12-31-2099'").append(lineSeparator);
			stagingFileContentsBuffer.append("WHEN @DateStringConverted like '000000_' THEN '01-01-1900'").append(lineSeparator);
			stagingFileContentsBuffer.append("ELSE CAST(LEFT(@DateStringConverted,1) + 19 AS VARCHAR) + CAST(SUBSTRING(@DateStringConverted, 2, 6) AS VARCHAR)").append(lineSeparator);
			stagingFileContentsBuffer.append("END)").append(lineSeparator);
			stagingFileContentsBuffer.append(" /* Check if the input string is proper date.*/").append(lineSeparator);
			stagingFileContentsBuffer.append("IF ISDATE(@DateString) = 0").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorMessage = @TextMessage + CONVERT(VARCHAR,@SourceDate)").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorNumber = 99997").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("ELSE").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ResultDate = CAST(@DateString AS DATE)").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorNumber = 0").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("/*The Converted date, Error number & Error description is stored in the below table, and passed to the calling procedure*/").append(lineSeparator);
			stagingFileContentsBuffer.append("INSERT INTO @ConvertedTable VALUES (@ResultDate,@ErrorNumber,@ErrorMessage)").append(lineSeparator);
			stagingFileContentsBuffer.append("RETURN ").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("GO").append(lineSeparator);

			stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
        	//Create Function  FNC_DFC_ConvertDateYYYYMM In GDC DB		
			stagingFileContentsBuffer.append("CREATE FUNCTION ["+tableInformationBean.getTargetSchemaName()+"].[FNC_DFC_ConvertDateYYYYMM]").append(lineSeparator);
			stagingFileContentsBuffer.append("( @SourceDate DECIMAL(6,0))").append(lineSeparator);
			stagingFileContentsBuffer.append("RETURNS @ConvertedTable TABLE (ConvertedDate DATE, ErrorNumber INT,ErrorDescription varchar(1000))").append(lineSeparator);
			stagingFileContentsBuffer.append("AS").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @ResultDate DATE").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @ErrorMessage VARCHAR(MAX)").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @ErrorNumber INT").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @TextMessage VARCHAR(50)").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @DateStringConverted VARCHAR(10)").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @DateString VARCHAR(10)").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @TextMessage = 'Error in Date conversion - '").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorNumber = 0").append(lineSeparator);			
			stagingFileContentsBuffer.append("SET @ErrorMessage = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("/* Converting input decimal value as string */	").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @DateStringConverted = CAST(@SourceDate AS VARCHAR)").append(lineSeparator);
			stagingFileContentsBuffer.append("/* Check if input is NULL*/").append(lineSeparator);
			stagingFileContentsBuffer.append("IF ISNULL(@DateStringConverted,'A') = 'A'").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ResultDate = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorNumber = 0").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorMessage = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("ELSE").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @DateStringConverted = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @DateStringConverted = RIGHT('000000' + CONVERT(VARCHAR(6),@SourceDate), 6)").append(lineSeparator);
			stagingFileContentsBuffer.append("SELECT @DateString = (CASE WHEN @DateStringConverted like '999999' THEN '12-31-2099'").append(lineSeparator);
			stagingFileContentsBuffer.append("WHEN @DateStringConverted like '00000_' THEN '01-01-1900'").append(lineSeparator);
			stagingFileContentsBuffer.append("ELSE CAST(@DateStringConverted +'01' AS VARCHAR)").append(lineSeparator);
			stagingFileContentsBuffer.append("END)").append(lineSeparator);
			stagingFileContentsBuffer.append(" /* Check if the input string is proper date.*/").append(lineSeparator);
			stagingFileContentsBuffer.append("IF ISDATE(@DateString) = 0").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorMessage = @TextMessage + CONVERT(VARCHAR,@SourceDate)").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorNumber = 99997").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("ELSE").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ResultDate = CAST(@DateString AS DATE)").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorNumber = 0").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("/*The Converted date, Error number & Error description is stored in the below table, and passed to the calling procedure*/").append(lineSeparator);
			stagingFileContentsBuffer.append("INSERT INTO @ConvertedTable VALUES (@ResultDate,@ErrorNumber,@ErrorMessage)").append(lineSeparator);
			stagingFileContentsBuffer.append("RETURN ").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("GO").append(lineSeparator);
			stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);

        	//Create Function  FNC_DFC_ConvertDateYYYYMMDD In GDC DB					
			stagingFileContentsBuffer.append("CREATE FUNCTION ["+tableInformationBean.getTargetSchemaName()+"].[FNC_DFC_ConvertDateYYYYMMDD]").append(lineSeparator);
			stagingFileContentsBuffer.append("( @SourceDate DECIMAL(8,0))").append(lineSeparator);
			stagingFileContentsBuffer.append("RETURNS @ConvertedTable TABLE (ConvertedDate DATE, ErrorNumber INT,ErrorDescription varchar(1000))").append(lineSeparator);
			stagingFileContentsBuffer.append("AS").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @ResultDate DATE").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @ErrorMessage VARCHAR(MAX)").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @ErrorNumber INT").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @TextMessage VARCHAR(50)").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @DateStringConverted VARCHAR(10)").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @DateString VARCHAR(10)").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @TextMessage = 'Error in Date conversion - '").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorNumber = 0").append(lineSeparator);			
			stagingFileContentsBuffer.append("SET @ErrorMessage = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("/* Converting input decimal value as string */	").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @DateStringConverted = CAST(@SourceDate AS VARCHAR)").append(lineSeparator);
			stagingFileContentsBuffer.append("/* Check if input is NULL*/").append(lineSeparator);
			stagingFileContentsBuffer.append("IF ISNULL(@DateStringConverted,'A') = 'A'").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ResultDate = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorNumber = 0").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorMessage = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("ELSE").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @DateStringConverted = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @DateStringConverted = RIGHT('00000000' + CONVERT(VARCHAR(8),@SourceDate), 8)").append(lineSeparator);
			stagingFileContentsBuffer.append("SELECT @DateString = (CASE WHEN @DateStringConverted like '99999999' THEN '12-31-2099'").append(lineSeparator);
			stagingFileContentsBuffer.append("WHEN @DateStringConverted like '0000000_' THEN '01-01-1900'").append(lineSeparator);
			stagingFileContentsBuffer.append("ELSE @DateStringConverted").append(lineSeparator);
			stagingFileContentsBuffer.append("END)").append(lineSeparator);
			stagingFileContentsBuffer.append(" /* Check if the input string is proper date.*/").append(lineSeparator);
			stagingFileContentsBuffer.append("IF ISDATE(@DateString) = 0").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorMessage = @TextMessage + CONVERT(VARCHAR,@SourceDate)").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorNumber = 99997").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("ELSE").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ResultDate = CAST(@DateString AS DATE)").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorNumber = 0").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("/*The Converted date, Error number & Error description is stored in the below table, and passed to the calling procedure*/").append(lineSeparator);
			stagingFileContentsBuffer.append("INSERT INTO @ConvertedTable VALUES (@ResultDate,@ErrorNumber,@ErrorMessage)").append(lineSeparator);
			stagingFileContentsBuffer.append("RETURN ").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("GO").append(lineSeparator);
			stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
			
        	//Create Function  FNC_DFC_ConvertTimeHHMMSS In GDC DB				
			stagingFileContentsBuffer.append("CREATE FUNCTION ["+tableInformationBean.getTargetSchemaName()+"].[FNC_DFC_ConvertTimeHHMMSS]").append(lineSeparator);
			stagingFileContentsBuffer.append("( @SourceTime DECIMAL(6,0))").append(lineSeparator);
			stagingFileContentsBuffer.append("RETURNS @ConvertedTable TABLE (ConvertedTime TIME, ErrorNumber INT,ErrorDescription varchar(1000))").append(lineSeparator);
			stagingFileContentsBuffer.append("AS").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @ResultTime TIME").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @ErrorMessage VARCHAR(MAX)").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @ErrorNumber INT").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @TextMessage VARCHAR(50)").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @TimeStringConverted VARCHAR(10)").append(lineSeparator);
			stagingFileContentsBuffer.append("DECLARE @TimeString VARCHAR(10)").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @TextMessage = 'Error in Time conversion - '").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorNumber = 0").append(lineSeparator);			
			stagingFileContentsBuffer.append("SET @ErrorMessage = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("/* Converting input decimal value as string */	").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @TimeStringConverted = CAST(@SourceTime AS VARCHAR)").append(lineSeparator);
			stagingFileContentsBuffer.append("/* Check if input is NULL*/").append(lineSeparator);
			stagingFileContentsBuffer.append("IF ISNULL(@TimeStringConverted,'A') = 'A'").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ResultTime = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorNumber = 0").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorMessage = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("ELSE").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @TimeStringConverted = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @TImeStringConverted = RIGHT('000000' + CONVERT(VARCHAR(6),@SourceTime), 6)").append(lineSeparator);
			stagingFileContentsBuffer.append("/* Check if the input string is proper Time.*/").append(lineSeparator);
			stagingFileContentsBuffer.append("IF(SUBSTRING(@TimeStringConverted,1,2)< '24' AND SUBSTRING(@TimeStringConverted,3,2)< '60' AND SUBSTRING(@TimeStringConverted,5,2)<'60')").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SELECT @TimeString = SUBSTRING(@TimeStringConverted,1,2) + ':' + SUBSTRING(@TimeStringConverted,3,2) + ':' + SUBSTRING(@TimeStringConverted,5,2)").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorNumber = 0").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ResultTime = CAST(@TimeString AS TIME)").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("ELSE	").append(lineSeparator);
			stagingFileContentsBuffer.append("BEGIN").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorNumber = 99997 ").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ErrorMessage = @TextMessage + CONVERT(VARCHAR(20),@SourceTime)").append(lineSeparator);
			stagingFileContentsBuffer.append("SET @ResultTime = NULL").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("/*The Converted Time, Error number & Error description is stored in the below table, and passed to the calling procedure*/").append(lineSeparator);
			stagingFileContentsBuffer.append("INSERT INTO @ConvertedTable VALUES (@ResultTime,@ErrorNumber,@ErrorMessage)").append(lineSeparator);
			stagingFileContentsBuffer.append("RETURN").append(lineSeparator);
			stagingFileContentsBuffer.append("END").append(lineSeparator);
			stagingFileContentsBuffer.append("GO").append(lineSeparator);
			stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
         	stagingFileContentsBuffer.append(lineSeparator);
			
         	
         	
        	StringBuffer triggerStagFileName = new StringBuffer(outputPath).append("OneTimeSetupScript");
        	writeToFile(triggerStagFileName.toString(), stagingFileContentsBuffer);
        	stagingFileContentsBuffer = null;

           }

}
